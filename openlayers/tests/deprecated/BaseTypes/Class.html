<html>
<head>
  <script src="../../OLLoader.js"></script>
  <script src="../../../lib/deprecated.js"></script>
  <script type="text/javascript">
    // remove this next line at 3.0
    var isMozilla = (navigator.userAgent.indexOf("compatible") == -1);
    
    // Remove this at 3.0
    function test_Cl***REMOVED***_backwards(t) {
        t.plan(4);
        // test that a new style cl***REMOVED*** supports old style inheritance
        var NewCl***REMOVED*** = OpenLayers.Cl***REMOVED***({
            newProp: "new",
            initialize: function() {
                t.ok(false, "the base cl***REMOVED*** is never instantiated");
            },
            toString: function() {
                return "new style";
            }
        });
        
        var OldCl***REMOVED*** = OpenLayers.Cl***REMOVED***.create();
        OldCl***REMOVED***.prototype = OpenLayers.Cl***REMOVED***.inherit(NewCl***REMOVED***, {
            oldProp: "old",
            initialize: function() {
                t.ok(true, "only the child cl***REMOVED*** constructor is called");
            }
        });
        
        var oldObj = new OldCl***REMOVED***();
        t.eq(oldObj.oldProp, "old",
             "old style cl***REMOVED***es can still be instantiated");
        t.eq(oldObj.newProp, "new",
             "old style inheritance of properties works with new style base");
        t.eq(oldObj.toString(), "new style",
             "toString inheritance works with backwards style");
        
    }

    // Remove this at 3.0
    function test_Cl***REMOVED***_create (t) {
        t.plan( 3 );
        var cls = OpenLayers.Cl***REMOVED***.create();
        cls.prototype = {
            initialize: function () {
                if (isMozilla)
                    t.ok(this instanceof cls,
                                "initialize is called on the right cl***REMOVED***");
                else
                    t.ok(true, "initialize is called");
            }
        };
        var obj = new cls();
        t.eq(typeof obj, "object", "obj is an object");
        if (isMozilla)
            t.ok(obj instanceof cls,
                        "object is of the right cl***REMOVED***");
        else
            t.ok(true, "this test doesn't work in IE");
    }

    // Remove this at 3.0
    function test_Cl***REMOVED***_inherit (t) {
        t.plan( 20 );
        var A = OpenLayers.Cl***REMOVED***.create();
        var initA = 0;
        A.prototype = {
            count: 0,
            mixed: false,
            initialize: function () {
                initA++;
                this.count++;
            }
        };

        var B = OpenLayers.Cl***REMOVED***.create();
        var initB = 0;
        B.prototype = OpenLayers.Cl***REMOVED***.inherit( A, {
            initialize: function () {
                A.prototype.initialize.apply(this, arguments);
                initB++;
                this.count++;
            }
        });

        var mixin = OpenLayers.Cl***REMOVED***.create()
        mixin.prototype = {
            mixed: true
        };

        t.eq( initA, 0, "cl***REMOVED*** A not inited" );
        t.eq( initB, 0, "cl***REMOVED*** B not inited" );

        var objA = new A();
        t.eq( objA.count, 1, "object A init" );
        t.eq( initA, 1, "cl***REMOVED*** A init" );
        if (isMozilla) 
            t.ok( objA instanceof A, "obj A isa A" );
        else
            t.ok( true, "IE sucks" );

        var objB = new B();
        t.eq( initA, 2, "cl***REMOVED*** A init" );
        t.eq( initB, 1, "cl***REMOVED*** B init" );
        t.eq( objB.count, 2, "object B init twice" );
        if (isMozilla) {
            t.ok( objB instanceof A, "obj B isa A" );
            t.ok( objB instanceof B, "obj B isa B" );
        } else {
            t.ok( true, "IE sucks" );
            t.ok( true, "IE sucks" );
        }

        var C = OpenLayers.Cl***REMOVED***.create();
        C.prototype = OpenLayers.Cl***REMOVED***.inherit( B, mixin, {count: 0} );
        t.eq( initA, 2, "cl***REMOVED*** A init unchanged" );
        t.eq( initB, 1, "cl***REMOVED*** B init unchanged" );
        
        var objC = new C();
        t.eq( initA, 3, "cl***REMOVED*** A init changed" );
        t.eq( initB, 2, "cl***REMOVED*** B init changed" );
        t.eq( objC.count, 2, "object C init changed" );
        if (isMozilla) {
            t.ok( objC instanceof A, "obj C isa A" );
            t.ok( objC instanceof B, "obj C isa B" );
            t.ok( objC instanceof C, "obj C isa C" );
            t.ok( !(objC instanceof mixin), "obj C isn'ta mixin" );
        } else {
            t.ok( true, "IE sucks" );
            t.ok( true, "IE sucks" );
            t.ok( true, "IE sucks" );
            t.ok( true, "IE sucks" );
        }
        t.eq( objC.mixed, true, "cl***REMOVED*** C has mixin properties" );
    }

  </script>
</head>
<body>
</body>
</html>
